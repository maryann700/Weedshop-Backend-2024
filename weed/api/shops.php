<?phpinclude(__DIR__ . "/../system/config.inc.php");if(empty($_SERVER['HTTP_APPKEY'])) {    $result = array("response"=>"false","msg"=>"Please provide api key.","data"=>array());} else if($_SERVER['HTTP_APPKEY'] != APPKEY) {    $result = array("response"=>"false","msg"=>"Please provide valid api key.","data"=>array());} else if(!isset($_POST["page"]) || empty($_POST["page"])) {    $result = array("response"=>"false","msg"=>"Please provide page number.","data"=>array());} else if(!isset($_POST["latitude"]) || empty($_POST["latitude"])) {    $result = array("response"=>"false","msg"=>"Please provide latitude.","data"=>array());} else if(!isset($_POST["longitude"]) || empty($_POST["longitude"])) {    $result = array("response"=>"false","msg"=>"Please provide longitude.","data"=>array());} else {    $db->where ("status","Active");    if(isset($_POST['region']) && $_POST['region'] != "") {        $db->where ("region",trim($_POST['region']));    }    $dist = "";    $lat = $_POST["latitude"];    $lng = $_POST["longitude"];    $dist = ",( 6371 * acos( cos( radians({$lat}) ) * cos( radians( `latitude` ) ) * cos( radians( `longitude` ) - radians({$lng}) ) + sin( radians({$lat}) ) * sin( radians( `latitude` ) ) ) ) AS distance";    //$distance = "20";    if(isset($_POST['distance']) &&  $_POST['distance'] != "" &&  $_POST['distance'] != 0) {                        $distance = $_POST['distance'];        $db->having ('distance', $distance, "<=");    }     //$db->having ('distance', $distance, "<=");        $db->orderBy ("id","asc");    $page = $_POST["page"];    // set page limit to 2 results per page. 20 by default    $db->pageLimit = 10;    $store = $db->arraybuilder()->paginate("store", $page,'store.*,CONCAT("'.STORE_PROFILE_IMG_URL.'",`image`) AS `image_url`,CONCAT("'.STORE_PROFILE_IMG_URL.'",`logo`) AS `logo_url`'.$dist);    //$store = $db->get ('store',null,'store.*,CONCAT("'.STORE_PROFILE_IMG_URL.'",`image`) AS `image_url`,CONCAT("'.STORE_PROFILE_IMG_URL.'",`logo`) AS `logo_url`'.$dist);    // echo $db->getLastQuery(); exit;    $totalPages = $db->totalPages;    if($db->count > 0) {        $result = array("response"=>"true","msg"=>"Stores found!","data"=>$store,"totalPages"=>$totalPages);     } else {        $result = array("response"=>"false","msg"=>"Not any store found!","data"=>array());     }}echo sendResponse($result);exit;