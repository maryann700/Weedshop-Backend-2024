<?phpinclude(__DIR__ . "/../system/config.inc.php");if(empty($_SERVER['HTTP_APPKEY'])) {    $result = array("response"=>"false","msg"=>"Please provide api key.","data"=>array());} else if($_SERVER['HTTP_APPKEY'] != APPKEY) {    $result = array("response"=>"false","msg"=>"Please provide valid api key.","data"=>array());} else if(!isset($_POST["driver_id"]) || empty($_POST["driver_id"])) {    $result = array("response"=>"false","msg"=>"Please provide driver id.","data"=>array());} else if(!isset($_POST["latitude"]) || empty($_POST["latitude"])) {    $result = array("response"=>"false","msg"=>"Please provide latitude.","data"=>array());} else if(!isset($_POST["longitude"]) || empty($_POST["longitude"])) {    $result = array("response"=>"false","msg"=>"Please provide longitude.","data"=>array());} else {    $driver_id = $_POST["driver_id"];    $lat = $_POST["latitude"];    $lng = $_POST["longitude"];        $db->where ("id", $driver_id);    //$db->where ("status", 'Active');    $driver = $db->getOne ("driver");    if ($db->count > 0) {            if($driver['status']=="Active") {                          $db->where("driver_id",$driver_id);            $position = $db->getOne("driver_location");            if($db->count<=0){                $data = array(                    "driver_id"=>$driver_id,                    "created_date"=>date("Y-m-d H:i:s")                );                $pos_id = $db->insert("driver_location",$data);                $position['id'] = $pos_id;                            }                       $address = getAddress($lat,$lng);                        $pdata = array(                "driver_id"=>$driver_id,                "latitude"=>$lat,                "longitude"=>$lng,                "address"=>$address,                "updated_date"=>date("Y-m-d H:i:s")            );            $db->where("id",$position['id']);            $db->where("driver_id",$driver_id);            if($db->update("driver_location",$pdata)) {                $result = array("response"=>"true","msg"=>"Driver location updated","data"=>array("driver_id"=>$driver_id));            } else {                $result = array("response"=>"false","msg"=>"Error! failed driver location update.","data"=>array());            }                       } else {           $result = array("response"=>"false","msg"=>"Driver status is inactive.","data"=>array());         }    } else {        $result = array("response"=>"false","msg"=>"Driver not found.","data"=>array());    }}echo sendResponse($result);exit;?>